{% extends "base.html" %}

{% block userscript %}
<link rel="stylesheet" type="text/css" href="../static/css/tab.css">

<script type="text/javascript" charset="utf8" src="../static/js/tab_info.js"></script>
<script type="text/javascript" charset="utf8" src="../static/js/table.js"></script>
<script type="text/javascript" charset="utf8" src="../static/js/tab.js"></script>
{% endblock %}

{% block content %}

<!--<link rel="stylesheet" type="text/css" href="../static/css/list.css">-->
<div class="column is-10" id="page-content">
    <nav class="breadcrumb" aria-label="breadcrumbs">
  <ul>
      <li><a href="{{ url_for('main.dashboard') }}">Dashboard</a></li>
    <li><a href="{{ url_for('main.scanner') }}">Scanner</a></li>
    <li class="is-active"><a href="#" aria-current="page">{{uid.uuid}}</a></li>
  </ul>
</nav>

    <div class="card">
  <div class="card-content">
    <div class="media">
      <div class="media-content">
        <p class="title is-4">{{uid.ip}} <span class="tag is-warning">{{uid.tag}}</span></p>
        <p class="subtitle is-6">{{uid.uuid}}</p>
      </div>
    </div>
    <div class="content">
      <time datetime="2016-1-1">{{uid.dateofreg}}</time>
    </div>
  </div>
</div>

    <div class="tabs is-toggle is-toggle-rounded">
    <ul>
      <li id="all-tab" class="is-active">
        <a onClick="switchToAll()">
        <span class="icon is-small"><i class="fa fa-server"></i></span>
        <span>Open Port</span>
      </a>
      </li>
      <li id="adaptivedesign-tab-vulnerabilities">
        <a onClick="switchToAdaptiveDesignUpdate()">
        <span class="icon is-small"><i class="fa fa-calendar"></i></span>
        <span>Vulnerabilities</span>
      </a>
      </li>
    </ul>
    <!--/tabs is-centered-->
  </div>
<nav class="level is-mobile">
  <div class="level-item has-text-centered">
    <div>
      <p class="heading">TOTAL VULNERABILITY</p>
      <p class="title">{{cntV}}</p>
    </div>
  </div>
  <div class="level-item has-text-centered">
    <div>
      <p class="heading">TOTAL EXPLOIT</p>
      <p class="title">{{cntE}}</p>
    </div>
  </div>
    <div class="level-item has-text-centered">
    <div>
      <p class="heading">TOTAL DIRECTORY</p>
      <p class="title">{{cntD}}</p>
    </div>
  </div>
    <div class="level-item has-text-centered">
    <div>
      <p class="heading">LOGIN OR PASSWORD</p>
      <p class="title">{{cntP}}</p>
    </div>
  </div>
    <div class="level-item has-text-centered">
    <div>
      <p class="heading">AVERAGE SCORE CVE</p>
      <p class="title">{{avgS}}</p>
    </div>
  </div>
</nav>
    <div class="table-container" id="all-tab-content">
        <table id="info_scanner_id" class="display" style="width:100%">
        <thead>
            <tr>
                <th>Port</th>
                <th><div style="width: 40px;">Protocol</div></th>
                <th>Name</th>
                <th>Service name</th>
                <th>Service version</th>
                <th>State</th>
            </tr>
        </thead>
        <tbody>
        {% for item in uid.port %}
            <tr>
                <th>{{item.port}}</th>
                <th>{{item.protocol}}</th>
                <th>{{item.name}}</th>
                <th>{{item.service_name}}</th>
                <th>{{item.service_version}}</th>
                <th>{{item.state}}</th>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
    <div class="is-hidden" id="adaptivedesign-tab-update-content">
        <div id="tabs" >
	<!-- Кнопки -->
	<ul class="tabs-nav">
        {% for item in uid.port %}
		<li><a href="#tab-{{item.port}}">{{item.port}} ({{item.name}})</a></li>
        {% endfor %}
        <li><a href="#tab-directory">Directory</a></li>
        <li><a href="#tab-password">Password</a></li>
	</ul>

	<div class="tabs-items">
        {% for item in uid.port %}
        <div class="tabs-item" id="tab-{{item.port}}">
            {% for inf in info_mng %}

                {% if inf.port == item.port  %}

<!--                    <p>{{inf}}</p>-->
            {% if inf.name == 'publicExploits'  %}
                <article class="message is-danger">
                    {% else  %}
                    <article class="message is-dark">
                    {% endif %}
                    <div class="message-header">
                        {% if inf.result.title  %}
                            <p>{{ inf.result.title }}</p>
                        {% else  %}
                            <p>None title</p>
                        {% endif %}

                    </div>

                    <div class="message-body">
<!--                        {{ inf }}-->
                        <p><strong>ID:</strong> {{ inf.id }}</p>
                        <p><strong>Name:</strong> {{ inf.name }}</p>
                        <p><strong>Last update:</strong> {{ inf.last_update }}</p>
                        <p><strong>Port name:</strong> {{ inf.port_name }}</p>
                        <p class="title is-3"></p>
                        <p><strong>CVE LIST:</strong> {{ inf.result.cvelist }}</p>
                        <p><strong>DESCRIPTIONS:</strong> {{ inf.result.description }}</p>
                        <a href="{{ inf.result.href }}"><strong>LINK:</strong> {{ inf.result.href }}</a>
                        <p><strong>TYPE:</strong> {{ inf.result.type }}</p>
                        <p><strong>PUBLISHED:</strong> {{ inf.result.published }}</p>
                        <p><strong>LAST SEEN:</strong> {{ inf.result.lastseen }}</p>
                        <p><strong>MODIFIED:</strong> {{ inf.result.modified }}</p>
                        <p><strong>CVSS SCORE:</strong> {{ inf.result.cvss.score }}</p>
                        <p><strong>VECTOR:</strong> {{ inf.result.cvss.vector }}</p>

                    </div>
                </article>
                {% endif %}
            {% endfor %}
		</div>
        {% endfor %}
        <div class="tabs-item" id="tab-directory">
            2
            </div>
        <div class="tabs-item" id="tab-password">
            1
            </div>
	</div>
</div>
     </div>
    </div>
{% endblock %}